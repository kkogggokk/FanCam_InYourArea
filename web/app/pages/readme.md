# Fproject


# 1. 데이터 수집
Selenium을 사용해 stayc 멤버의 이미지 데이터 수집
- [](https://github.com/SeleniumHQ/selenium)
- Google-image-crawling 사용하려 했으나 구글 정책 바뀜에 따라 막힘


< 문제점 & 해결방안 >
- 데이터 양의 부족
    - 신인 그룹이라 데이터 양이 적었다.
    - 그룹 변경 (stays -> black pink)
- 무대 사진 외의 기사 사진 등도 섞여있어 무대 영상을 예측 시 예측률이 떨어짐
    - 예측할 영상과 가장 유사한 데이터를 사용해야 좋은 결과를 낼 수 있겠다! 
    - 무대 직캠 영상을 지정 프레임마다 캡쳐해 데이터로 사용


# 2.  데이터 라벨링    
Lableimg-master 사용해 라벨링    
- [](https://github.com/tzutalin/labelImg)
* 데이터 라벨링 기준     
- 얼굴이 확실하게 구분 가능한 경우에만 라벨링    
- 동선/옷차림 등의 조건을 고려하지 않고도 구분 가능한 경우    
- 머리카락으로 얼굴이 가려져있거나 뒤돌아 있는 경우에는 라벨링 제외    
- 라벨링 사이즈: 헤어스타일이 나오게 라벨링(두상 - 어깨 선 정도까지)    
- 낮은 화질(360p)의 데이터도 구비    
- 총 2160장    


=> 화질이 낮은 데이터를 포함해 학습시켜 성능이 낮을 수도 있다는 멘토님 의견에 이후 1080p 데이터만 따로 추려서 학습 (총 1316장)        


# 3-1. 좌표 추출 / 정리?
영상 detect 시 --save-txt flag를 사용하여 예측 좌표 csv 파일로 저장    
저장한 csv파일을 각 멤버별로 분리    


	- 기존 yolov5 모델은 frame별로 예측한 좌표를 개별 txt 파일로 저장하는 형식    
		-> detect.py file 내부 함수를 수정해 영상 전체 txt 파일을 묶어 하나의 csv 파일로 저장되게 함
	# - 예측하지 못한 frame은 좌표가 출력되지 않음    
	#	-> 영상의 모든 frame별 좌표를 받아 crop 해야 하기 때문에 0으로 채운 dataframe을 만들고 둘을 합침    
	- null값 처리 / smoothing    
		- 이동평균 알고리즘      


# 3-2. 영상 크롭
Opencv 사용
멤버별 csv 파일에서 frame별 좌표값을 받아 각 frame을 crop 후 VideoWriter의 writer 메소드를 사용해 영상으로 저장


- 일부 프레임이 빠지고 저장되는 경우 발생    
    - > 원인 : 좌표에서 목표 범위 만큼 더하고 뺄 경우 기존 영상의 범위를 나가는 경우가 발생하여 writer 메소드 실행시 불포함하고 영상으로 저장    
    - > 해결 : 좌표 + 목표 영상크기가 범위 밖일 경우 영상 범위에서 목표크기로 추출할 수 있는 가장 끝값으로 출력하는 알고리즘 추가       


# 4. 모델


# 5. 웹

 
> -  한계점
> 1. 실시간 추론 불가 (시간이 오래 걸린다) + 변수가 너무 많아서 알고리즘으로 정확한 결과추출 한계 , 얼굴을 구별할 수 없는 경우 발생하는 null값 실시간으로 채우기 힘듬
> 2. 댄서를 멤버로 예측하는 경우 발생 (학습 데이터 양 늘리면 해결 될까?)
> 3. 다른 그룹 예측 불가 (재사용성 ? 대체 단어가 …)
